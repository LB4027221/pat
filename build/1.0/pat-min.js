!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Pat=t():e.Pat=t()}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){function n(){return v++}var r=i(1),s=i(2),o=i(18),a=i(19),l=i(8),u=i(9),c=i(25),h=i(17),d=i(24),f=i(26),p=i(3),v=0,m=function(e){this.$el=p.query(e.el),this.$data=e.data||{},this.$rootView=e.rootView?e.rootView:this,this.__template=e.template,this.__dependViews=[],this.__watchers={},this.__userWatchers={},this.__filters=e.filters||{},this.__vid=e.vid||n(),this.__rendered=!1,this._init()};p.assign(m.prototype,f),m.prototype._init=function(){var e=null;this.$el;this.fire("beforeMount"),this.$el.__VD__?e=this.$el:this.__template?(this.$el.innerHTML="",e=c.transfer(this.__template)):(e=c.transfer(this.$el.innerHTML),this.$el.innerHTML=""),this.$data=this.$inject(this.$data),this.__depend(),this.fire("beforeCompile"),this.$compile(e),this.fire("afterCompile"),this.$el.__VD__?this.__rendered=!0:(this.$el.innerHTML=e.mountView(this),this.__rendered=!0,this.fire("afterMount"))},m.prototype.__depend=function(){var e=this;p.each(this.$data.__ori__,function(t,i){e.$watch(i,function(){e.__dependViews&&p.each(e.__dependViews,function(t){t.$data[i]=e.$data[i]})})})},m.prototype.$inject=function(e){return h.inject(e)},m.prototype.$flushUpdate=function(){return a.flushUpdate()},m.prototype.$apply=m.prototype.$flushUpdate,m.prototype.$compile=function(e){s.parse(e,this)},m.prototype.$destroy=function(){p.each(this.__watchers,function(e){e.destroy()}),this.$el&&this.$el.innerHTML&&(this.$el.innerHTML=""),this.$el=null,this.$data=null,this.$rootView=null,this.__template=null,this.__watchers=null,this.__userWatchers=null,this.__filters=null,this.isDestroyed=!0},m.config=function(e){p.assign(r,e)},m.prototype.$directive=l.newDirective,m.prototype.$watch=function(e,t){var i;this.__userWatchers[e]?(i=this.__userWatchers[e],i.callbacks.push(t)):(i=new o(this,u.parseExpression(e),t),i.last=i.getValue(),i.isUserWatcher=!0,this.__userWatchers[e]=i)},m.createElement=d.createElement,m.createTextNode=d.createTextNode,m.Parser=u,m.Dom=c,m.Directive=l,m.Compile=s,m.Watcher=o,m.Data=h,m.Element=d,e.exports=m},function(e,t){t.prefix="t",t.version="1.0",t.tagId="p-id",t.delimiters=["{{","}}"],t.unsafeDelimiters=["{{{","}}}"],t.defaultIterator="__INDEX__",t.debug=!1},function(e,t,i){function n(e){var t,i,n,r;return n=e.view,t=a.create(e),i=n.__watchers[e.value],i||(i=new l(n,e.expression),n.__watchers[e.value]=i),e.oneTime||i.__directives.push(t),t.__watcher=i,t.initialize&&t.initialize(),r=i.getValue(),i.last=r,t.bind(r),t}function r(e,i,r){var s,l,u;u=e===i.$el?!0:!1,r=r||[];var h=[],d=[];return o.each(r,function(t){a.isDirective(t)&&(s=c(t),s.view=i,s.el=e,s.block?d.push(s):h.push(s))}),!u&&d.length?void n(d[0]):(h.sort(function(e,t){return e=e.priority||100,t=t.priority||100,e>t?-1:e===t?0:1}),o.each(h,function(e){n(e)}),void(e.hasChildNodes()&&(l=o.toArray(e.childNodes),o.each(l,function(e){t.parse(e,i)}))))}function s(e,t){var i,r;i=h(e.data)[0],r=i.oneTime,i.type===u.TextTemplateParserTypes.binding&&n({name:"",value:i.value,view:t,expression:d(i.value),oneTime:r,directive:i.html?"html":"text",el:e})}var o=i(3),a=i(8),l=i(18),u=i(9),c=u.parseDirective,h=u.parseText,d=u.parseExpression;i(1);t.parse=function(e,t){o.isElement(e)&&(3==e.nodeType&&o.trim(e.data)&&s(e,t),1==e.nodeType&&"SCRIPT"!==e.tagName&&r(e,t,o.toArray(e.attributes)),-1==e.nodeType&&r(e,t,o.toArray(e.attributes)))}},function(e,t,i){var n={},r=i(4),s=i(5),o=i(6),a=s.assign;a(n,s),a(n,r),a(n,o),n.Class=i(7),e.exports=n},function(e,t,i){function n(e,t){var i=e.nodeType;return i&&s.inArray([1,8],i)?8===i&&s.trim(e.data)==="deleted-"+t?e:1===i&&e.getAttribute&&parseInt(e.getAttribute(TAG_ID))===t?e:null:!1}var r=i(1),s=i(5);TAG_ID=r.tagId,t.query=function(e){return e?s.isObject(e)&&1==e.__VD__?e:s.isElement(e)?e:s.isString(e)?document.getElementById(e.replace(/^#/,"")):void 0:null},t.walk=function(e,i){if(e.hasChildNodes())for(var n=0;n<e.childNodes.length&&i(e.childNodes[n])!==!1;n++)t.walk(e.childNodes[n],i)},t.queryPatId=function(e,i){var r=null;return t.walk(e,function(e){return n(e,i)?(r=e,!1):void 0}),r};var o=document.querySelector?function(e,t){return e.querySelector("["+TAG_ID+'="'+t+'"]')}:t.queryPatId;t.queryRealDom=function(e){var i=e.view.$rootView.$el,n=e.patId,r=null;if(e.deleted){var s;if(s=e.parentNode.__ROOT__?i:o(i,e.parentNode.patId),!s)return null;r=t.queryPatId(s,n)}else r=o(i,n);return r},t.createAnchor=function(e,t){var i=r.debug?document.createComment(e):document.createTextNode(t?" ":"");return i},t.before=function(e,t){t.parentNode.insertBefore(e,t)},t.after=function(e,i){i.nextSibling?t.before(e,i.nextSibling):i.parentNode.appendChild(e)},t.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)},t.prepend=function(e,i){i.firstChild?t.before(e,i.firstChild):i.appendChild(e)};var a={area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],col:[2,"<table><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table>","</table>"],td:[3,"<table><tr>","</tr></table>"],g:[1,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',"</svg>"],_default:[0,"",""]};a.th=a.td,a.optgroup=a.option,a.tbody=a.tfoot=a.colgroup=a.caption=a.thead;var l=/<([\w:]+)/;t.string2node=function(e){return t.string2frag(e).childNodes[0]},t.string2frag=function(e){var t=document.createElement("div"),i=document.createDocumentFragment(),n=(l.exec(e)||["",""])[1].toLowerCase(),r=a[n]||a._default,o=r[0],u=r[1],c=r[2];for(t.innerHTML=u+s.trim(e)+c;o--;)t=t.lastChild;for(var h;h=t.firstChild;)i.appendChild(h);return i},t.replace=function(e,t){var i=e.parentNode;i&&i.replaceChild(t,e)},t.nextTick=function(){function e(){n=!1;var e=i.slice(0);i=[];for(var t=0;t<e.length;t++)e[t]()}var t,i=[],n=!1;if("undefined"!=typeof MutationObserver){var r=1,s=new MutationObserver(e),o=document.createTextNode(r);s.observe(o,{characterData:!0}),t=function(){r=(r+1)%2,o.data=r}}else t=setTimeout;return function(r,s){var o=s?function(){r.call(s)}:r;i.push(o),n||(n=!0,t(e,0))}}()},function(e,t){function i(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}t.bind=function(e,t){return function(i){var n=arguments.length;return n?n>1?e.apply(t,arguments):e.call(t,i):e.call(t)}},t.htmlspecialchars=function(e){return t.isString(e)?(e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e=e.replace(/'/g,"&#039;")):e},t.trim=function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},t.toArray=function(e){if(!e||!e.length)return[];for(var t=[],i=0,n=e.length;n>i;i++)t.push(e[i]);return t};var n=Object.prototype.toString;t.isArray=function(e){return"[object Array]"===n.call(e)},t.isPlainObject=function(e){return"[object Object]"===n.call(e)},t.isObject=function(e){return"function"==typeof e||"object"==typeof e&&null!=e},t.isElement=function(e){return e&&"object"==typeof e&&e.nodeType},t.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},t.isNumber=function(e){return"[object Number]"===Object.prototype.toString.call(e)},t.each=function(e,i){if(t.isArray(e))for(var n=0,r=e.length;r>n;n++)i(e[n],n);else if(t.isObject(e))for(var s in e)i(e[s],s)},t.assign=function(){if(!(arguments.length<2)){for(var e,n=t.toArray(arguments),r=n.shift();e=n.shift();)i(r,e);return r}},t.hasKey=function(e,t){for(var i in e)if(e.hasOwnProperty(i)&&i==t)return!0;return!1},t.inArray=function(e,i){var n=t.indexOf(e,i);return-1===n?!1:!0},t.indexOf=function(e,t){if(null===e)return-1;for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1},t.findAndRemove=function(e,i){var n=t.indexOf(e,i);~n&&e.splice(n,1)},t.indexOfKey=function(e,t,i){if(null===e)return-1;for(var n=0,r=e.length;r>n;n++)if(e[n][t]===i)return n;return-1};var r=function(){return!1};t.deepClone=function(e,i){if(i=i||r,t.isPlainObject(e)){var n={};for(var s in e)e.hasOwnProperty(s)&&!i(s)&&(n[s]=t.deepClone(e[s],i));return n}if(t.isArray(e)){for(var n=new Array(e.length),o=0,a=e.length;a>o;o++)n[o]=t.deepClone(e[o],i);return n}return e}},function(e,t,i){i(1),i(5),void 0!==window.console&&console.log},function(e,t){var i=function(){function e(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}var t=function(){this.initPrototype=!0;var i=new this;this.initPrototype=!1;for(var n,r=Array.prototype.slice.call(arguments)||[];n=r.shift();)e(i,n.prototype||n);var s=function(){!s.initPrototype&&this.init&&this.init.apply(this,arguments)};return s.prototype=i,s.prototype.constructor=s,s.extend=t,s},i=function(){};return i.extend=t,i}();e.exports=i},function(e,t,i){var n=i(3),r=n.Class,s=i(9),o=i(1);DIR_REGX=s.DIR_REGX,INTERPOLATION_REGX=s.INTERPOLATION_REGX;var a={bind:i(11),"class":i(12),model:i(13),"if":i(14),unless:i(15),"for":i(16),text:i(22),html:i(23)},l=function(){};uid=0;var u=r.extend({init:function(e){this.__watcher=null,this.describe=e,this.el=e.el,this.view=e.view,this.uid=uid++},shoudUpdate:function(e,t){return e!==t},initialize:l,bind:l,unbind:l,update:l,destroy:function(){this.unbind(),this.__watcher=null,this.describe=null,this.el=null,this.view=null,this.uid=null,this.isDestroyed=!0}}),c={};n.each(a,function(e,t){c[t]=u.extend(a[t])}),e.exports={__directives:a,publics:c,create:function(e){var t=c[e.directive];return new t(e)},isBlockDirective:function(e){var t=n.isString(e)?e:e.name;return t=t.replace(o.prefix+"-",""),a[t]&&a[t].block?!0:!1},isDirective:function(e){var t,i,r;return t=e.name,(i=e.value)?INTERPOLATION_REGX.test(i)?!0:(r=t.match(DIR_REGX),r&&r[1]&&n.hasKey(a,r[1].split(":")[0])?!0:!1):!1},newDirective:function(e,t){a[e]=t,this.publicDirectives[e]=u.extend(t)}}},function(e,t,i){function n(e){return e.replace(l,"\\$&")}var r=i(1),s=i(3),o=i(10),a=r.prefix,l=(r.delimiters,/[-.*+?^${}()|[\]\/\\]/g),u=new RegExp("^"+a+"-([^=]+)"),c=/:(.*)$/,h=n(r.delimiters[0]),d=n(r.delimiters[1]),f=n(r.unsafeDelimiters[0]),p=n(r.unsafeDelimiters[1]),v=new RegExp(f+"(.+?)"+p+"|"+h+"(.+?)"+d,"g"),m=new RegExp("^"+f+".*"+p+"$"),_=new RegExp(f+"(.+?)"+p+"|"+h+"(.+?)"+d);t.parseDirective=function(e){var n,r,s,o,a=e.name,l=e.value;if(_.test(l))return r=t.parseText(l),{name:a,value:l,directive:"bind",args:[a],oneTime:!1,block:!1,expression:t.token2expression(r),isInterpolationRegx:!0};s=a.match(u)[1],c.test(s)&&(o=s.split(":"),s=o[0],n=o[1]?o[1].split("|"):[]);var h=i(8).__directives[s]||{};return{name:a,value:l,directive:s,args:n||[],oneTime:!1,block:h.block,priority:h.priority,expression:t.parseExpression(l)}},t.parseExpression=function(e){var t,i,n;return n=e.lastIndexOf("|"),-1!=n&&"|"!==e.charAt(n-1)&&(t=s.trim(e.substr(n+1)),e=e.substr(0,n)),i=s.trim(o.compileExpFns(e)),t&&(i="_that.applyFilter("+i+',"'+t+'")'),i},TextTemplateParserTypes={text:0,binding:1},t.parseText=function(e){if(e=e.replace(/\n/g,""),!v.test(e))return[{type:TextTemplateParserTypes.text,value:e}];for(var t,i,n,r,o,a,l=[],u=v.lastIndex=0;t=v.exec(e);)i=t.index,i>u&&l.push({type:TextTemplateParserTypes.text,value:e.slice(u,i)}),n=m.test(t[0]),r=n?t[1]:t[2],o=r.charCodeAt(0),a=42===o,r=a?r.slice(1):r,l.push({type:TextTemplateParserTypes.binding,value:s.trim(r),html:n,oneTime:a}),u=i+t[0].length;return u<e.length&&l.push({type:TextTemplateParserTypes.text,value:e.slice(u)}),l},t.token2expression=function(e){var i=[];return s.each(e,function(e){e.type==TextTemplateParserTypes.text?i.push('"'+e.value+'"'):i.push("("+t.parseExpression(e.value)+")")}),i.join("+")},t.TAG_RE=v,t.INTERPOLATION_REGX=_,t.DIR_REGX=u,t.TextTemplateParserTypes=TextTemplateParserTypes},function(e,t,i){function n(e,t){var i=v.length;return v[i]=t?e.replace(h,"\\n"):e,'"'+i+'"'}function r(e){var t=e.charAt(0),i=e.slice(1);return a.test(i)?e:(i=i.indexOf('"')>-1?i.replace(f,s):i,t+"_scope."+i)}function s(e,t){return v[t]}var o=(i(3),"Math,Date,this,true,false,null,undefined,Infinity,NaN,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,parseInt,parseFloat"),a=new RegExp("^("+o.replace(/,/g,"\\b|")+"\\b)"),l="break,case,class,catch,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,let,return,super,switch,throw,try,var,while,with,yield,enum,await,implements,package,proctected,static,interface,private,public",u=new RegExp("^("+l.replace(/,/g,"\\b|")+"\\b)"),c=/\s/g,h=/\n/g,d=/[\{,]\s*[\w\$_]+\s*:|('[^']*'|"[^"]*")|new |typeof |void /g,f=/"(\d+)"/g,p=/[^\w$\.]([A-Za-z_$][\w$]*(\.[A-Za-z_$][\w$]*|\['.*?'\]|\[".*?"\])*)/g,v=[];t.compileExpFns=function(e,t){u.test(e),v.length=0;var i=e.replace(d,n).replace(c,"");return i=(" "+i).replace(p,r).replace(f,s)}},function(e,t,i){i(3);e.exports={priority:3e3,bind:function(e){this.update(e)},update:function(e){var t,i;t=this.describe.args||[],i=t[0],i&&(null!=e&&e!==!1?this.el.setAttribute(i,e):this.el.removeAttribute(i))}}},function(e,t,i){i(3);e.exports={priority:3500,bind:function(e){this.update(e)},update:function(e){var t,i;t=this.describe.args||[],i=t[0],i&&(null!=e&&e!==!1?this.el.addClass(i):this.el.removeClass(i))}}},function(e,t,i){var n=i(3);Util={bindEvent:function(){return"addEventListener"in window?function(e,t,i){return e.addEventListener(t,i,!1)}:function(e,t,i){return e.attachEvent("on"+t,i)}}(),unbindEvent:function(){return"removeEventListener"in window?function(e,t,i){return e.removeEventListener(t,i,!1)}:function(e,t,i){return i?e.detachEvent("on"+t,i):e.detachEvent("on"+t)}}(),getInputValue:function(e){var t,i,n,r;if("checkbox"===e.type)return e.checked;if("select-multiple"===e.type){for(r=[],i=0,n=e.length;n>i;i++)t=e[i],t.selected&&r.push(t.value);return r}return e.value}},e.exports={priority:3e3,bind:function(e){var t=this;t.blurFn=function(){var e=Util.getInputValue(t.el.getElement()),i=t.describe.value;e!=t.curValue&&(t.view.orikeys&&n.inArray(t.view.orikeys,i)?t.setValue(i,e,t.view.$rootView.$data):t.setValue(i,e,t.view.$data))},t.view.on("afterMount",function(){Util.bindEvent(t.el.getElement(),"blur",t.blurFn)}),this.update(e)},setValue:function(e,t,i){return new Function("$scope","return $scope."+e+'="'+t+'"')(i)},update:function(e){(void 0===e||null===e)&&(e=""),n.isString(e)&&(e=n.htmlspecialchars(e)),this.curValue=e,this.el.setAttribute("value",e)},unbind:function(){Util.unbindEvent(this.el.getElement(),"blur",self.blurFn)}}},function(e,t,i){i(3);e.exports={block:!0,priority:4e3,shoudUpdate:function(e,t){return!0},bind:function(e){var t=this;t.oriEl=t.el.clone(),e?(t.childView=new t.view.constructor({el:t.el,data:t.view.$data,rootView:t.view.$rootView}),t.view.__rendered?t.childView.fire("afterMount"):t.view.on("afterMount",function(){t.childView.fire("afterMount")}),t.bound=!0):(t.el.remove(!0),t.bound=!1)},update:function(e){if(e&&0==this.bound){var t=this.oriEl.clone();this.childView=new this.view.constructor({el:t,data:this.view.$data,rootView:this.view.$rootView}),this.el.replace(t),this.childView.fire("afterMount"),this.el=t,this.bound=!0}e||1!=this.bound||(this.el.remove(!0),this.childView.$destroy(),this.bound=!1)},unbind:function(){this.childView&&this.childView.$destroy()}}},function(e,t,i){var n=i(3),r=i(14);e.exports=n.assign({},r,{bind:function(e){return r.bind.call(this,!e)},update:function(e){return r.update.call(this,!e)}})},function(e,t,i){var n=i(3),r=i(9),s=r.parseExpression,o=i(17),a=i(1),l={MOVE_EXISTING:1,REMOVE_NODE:2,INSERT_MARKUP:3},u=0;e.exports={block:!0,priority:4e3,shoudUpdate:function(e,t){var i="lazy"==this.describe.args[0]?!0:!1;return i?e!==t:!0},initialize:function(){var e=this.describe.value.match(/(.*) in (.*)/);if(e){var t=e[1].match(/\((.*),(.*)\)/);t?(this.iterator=n.trim(t[1]),this.alias=n.trim(t[2])):(this.iterator=a.defaultIterator,this.alias=n.trim(e[1])),this.__watcher.expression=s(e[2])}this.oldViewMap={},this.oldViewLists=[],this.__node=this.el.clone(),this.orikeys=[];var i=this.view.$data.__ori__;for(var r in i)i.hasOwnProperty(r)&&this.orikeys.push(r)},bind:function(e){var t=this;this.startNode=this.el,this.startNode.remove(!0),this.isUpdated=!1,this.update(e),t.view.__rendered?t._fireChilds():t.view.on("afterMount",function(){t._fireChilds()})},_fireChilds:function(){n.each(this.oldViewLists,function(e){e.fire("afterMount")})},_generateKey:function(){return"key"+u++},_generateNewChildren:function(e){var t,i,r,s=this.newViewMap={},a=this.newViewLists=[],l=this.oldViewMap,u=this,c="__pat_key__";n.each(e,function(e,h){r=e[c],r&&l[r]&&l[r].$data[u.alias]===e?(s[r]=l[r],u.iterator&&(l[r].$data[u.iterator]=h)):(t={},n.each(u.orikeys,function(e){t[e]=u.view.$data[e]}),u.iterator&&(t[u.iterator]=h),t[u.alias]=e,t=o.define(t),i=u.__node.clone(),r=u._generateKey(),e[c]=r,s[r]=new u.view.constructor({el:i,data:t,vid:r,rootView:u.view.$rootView}),s[r].orikeys=u.orikeys,u.view.__dependViews.push(s[r])),a.push(s[r])})},_diff:function(){for(var e,t,i,n=0,r=0,s=this.oldViewMap,o=this.newViewMap,a=this.newViewLists,u=this.diffQueue=[],c=0,h=a.length;h>c;c++)i=a[c].__vid,e=s&&s[i],t=a[c],e===t?e._mountIndex<r&&u.push({name:i,type:l.MOVE_EXISTING,fromIndex:e._mountIndex,toIndex:n}):(e&&(r=Math.max(e._mountIndex,r),u.push({name:i,type:l.REMOVE_NODE,fromIndex:e._mountIndex,toIndex:null})),u.push({name:i,type:l.INSERT_MARKUP,fromIndex:null,toIndex:n,markup:t.$el})),t._mountIndex=n,n++;for(i in s)!s.hasOwnProperty(i)||o&&o.hasOwnProperty(i)||(e=s&&s[i],u.push({name:i,type:l.REMOVE_NODE,fromIndex:e._mountIndex,toIndex:null}))},_patch:function(){for(var e,t,i=this,r={},s=[],o=this.diffQueue,a=0;a<o.length;a++)e=o[a],(e.type===l.MOVE_EXISTING||e.type===l.REMOVE_NODE)&&(t=this.oldViewMap[e.name],r[e.name]=t.$el,s.push(t));n.each(s,function(e){e.$el==i.startNode?e.$el.remove(!0):e.$el.remove(),n.findAndRemove(i.view.__dependViews,e),e.$destroy()});for(var u=this._generateOldLists(),c=0;c<o.length;c++)switch(e=o[c],e.type){case l.INSERT_MARKUP:this.handleInsertMarkup(e,u);break;case l.MOVE_EXISTING:this._insertChildAt.call(this,r[e.name],e.toIndex,u);break;case l.REMOVE_NODE:}},handleInsertMarkup:function(e,t){var i=this._insertChildAt;i.call(this,e.markup,e.toIndex,t),this.isUpdated&&this.newViewMap[e.name]&&this.newViewMap[e.name].fire("afterMount")},_generateOldLists:function(){var e=this.oldViewLists,t=[];return this.startNode.deleted&&t.push(this.startNode),n.each(e,function(e){e&&e.isDestroyed!==!0&&t.push(e.$el)}),t},_insertChildAt:function(e,t,i){var n=this.startNode,r=i[i.length-1];n.deleted&&(t+=1),nextNode=i[t],nextNode?(e.before(nextNode),i.splice(t,0,e)):(e.after(r),i.push(e))},update:function(e){this._generateNewChildren(e),this._diff(),this._patch(),this.oldViewMap=this.newViewMap,this.oldViewLists=this.newViewLists,this.oldViewLists.length>0&&this.startNode.deleted&&(this.startNode.remove(),this.startNode=this.oldViewLists[0].$el),this.isUpdated=!0},unbind:function(){n.each(this.oldViewMap,function(e){e.$destroy()}),this.oldViewMap=null,this.oldViewLists=null}}},function(e,t,i){var n=(i(18),i(3)),r=i(20);i(21);var s=function(e,t){var i=e[t];return function(){return i.addWatcher(),n.isArray(i.val)&&!i.val.__ob__&&(i.val.__ob__=i),i.val}},o=function(e,i){var r=e[i];return function(e){e!==r.val&&(r.unique(),n.isObject(e)?(r.val=t.inject(e),r.depend()):r.val=e,r.notify())}},a=null;if(/MSIE\ [678]/.test(window.navigator.userAgent)){var l=0;window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\r\n"),"VBScript"),a=function(e){function t(e,t){d[e+"_set"]=t,c.push("	Public Property Let ["+e+"](value)",'		Call [_pro](me, "set", "'+e+'", value)',"	End Property","	Public Property Set ["+e+"](value)",'		Call [_pro](me, "set", "'+e+'", value)',"	End Property")}function i(e,t){d[e+"_get"]=t,c.push("	Public Property Get ["+e+"]","	On Error Resume Next","		Set ["+e+'] = [_pro](me, "get", "'+e+'")',"	If Err.Number <> 0 Then","		["+e+'] = [_pro](me, "get", "'+e+'")',"	End If","	On Error Goto 0","	End Property")}function n(e,t,i,n){return"get"==t?d[i+"_get"].apply(u,[n]):void d[i+"_set"].apply(u,[n])}var a,u,c=[],h=[],d={},f={},p={};for(var v in e)(!e.hasOwnProperty||e.hasOwnProperty(v))&&(p[v]=new r,p[v].val=e[v],f[v]={enumerable:!0,configurable:!0,get:s(p,v),set:o(p,v)});for(var v in f)f.hasOwnProperty(v)&&(f[v].set||f[v].get)&&(f[v].set&&t(v,f[v].set),f[v].get&&i(v,f[v].get));return c.push("	Public [__pat_key__]"),c.push("	Public [__ori__]"),c.push("	Public [__inject__]"),c.unshift("\r\n	Private [_acc], [_pro]","	Public Default Function [self](proxy)","		Set [_pro] = proxy","		Set [self] = me","	End Function"),c.push("End Class"),c=c.join("\r\n"),a="VB"+l++,h.push("Class "+a+c),h.push(["Function "+a+"F(proxy)","	Set "+a+"F = (New "+a+")(proxy)","End Function"].join("\r\n")),h=h.join("\r\n"),window.parseVB(h),u=window[a+"F"](n),u.__ori__=e,u.__inject__=!0,u}}else a=function(e){var t={},i={},n={};for(var a in e)e.hasOwnProperty(a)&&(i[a]=new r,n[a]=e[a],i[a].val=n[a],t[a]={enumerable:!0,configurable:!0,get:s(i,a),set:o(i,a)});return Object.defineProperties(n,t),n.__ori__=e,n.__inject__=!0,n};t.define=a,t.inject=function(e){var i=null;return e.__inject__?e:n.isArray(e)?(i=[],i.__inject__=!0,n.each(e,function(e){i.push(t.inject(e))}),i):n.isPlainObject(e)?(i=t.define(e),n.each(e,function(e,r){n.isObject(e)&&(i[r]=t.inject(e))}),i):e}},function(e,t,i){function n(){return a++}function r(e,t,i){this.__directives=[],this.__view=e,this.expression=t,this.callbacks=i?[i]:[],this.scope=e.$data,this.last=null,this.current=null,this.__depend=!1,this.id=n()}var s=i(3),o=i(19),a=1;r.currentTarget=null,r.prototype.applyFilter=function(e,t){if(!t)return e;var i=this.__view.$rootView.__filters[t];return i?i.call(this.__view.$rootView,e,this.scope):e},r.prototype.getValue=function(){if(!this.expression)return"";var e;try{this.__depend||(r.currentTarget=this),e=new Function("_scope","_that","return "+this.expression)(this.scope,this),this.__depend||(r.currentTarget=null)}catch(t){this.__depend||(r.currentTarget=null)}return this.__depend=!0,e},r.prototype.check=function(){var e=this;this.isUserWatcher?(this.current=this.getValue(),this.last!=this.current&&s.each(this.callbacks,function(t){t(e.last,e.current)}),this.last=this.current):o.update(this)},r.prototype.batchCheck=function(){var e=this,t=this.last,i=this.getValue();s.each(this.__directives,function(n){n.shoudUpdate(t,i)&&(e.__view.$rootView.fire("beforeDirectiveUpdate",n,t,i),n.update&&n.update(i),e.__view.$rootView.fire("afterDirectiveUpdate",n,t,i))}),this.last=this.current},r.prototype.destroy=function(){this.isDestroyed=!0,s.each(this.__directives,function(e){e.destroy&&e.destroy()})},e.exports=r},function(e,t,i){function n(){a&&(l=!0,r.each(s,function(e){e.isDestroyed||e.batchCheck(),o[e.id]=null}),s=[],o={},a=l=!1)}var r=i(3),s=[],o={},a=!1,l=!1;t.update=function(e){var t=e.id;if(!o[t]){if(l)return void e.batchCheck();s.push(e),o[t]=s.length,a||(a=!0,r.nextTick(n))}},t.flushUpdate=n},function(e,t,i){var n=i(3),r=i(18),s=n.Class,o=s.extend({init:function(){this.watchers=[]},addWatcher:function(e){var t=r.currentTarget,i=this.watchers;t&&-1==n.indexOf(i,t)&&i.unshift(t)},unique:function(){var e=this.watchers,t=[];n.each(e,function(e){e.isDestroyed||t.push(e)}),this.watchers=t},depend:function(){var e=this.watchers;n.each(e,function(e){e.__depend=!1,e.getValue()})},notify:function(){n.each(this.watchers,function(e){e.check()})}});e.exports=o},function(e,t,i){var n=i(3),r=i(17),s=["push","pop","shift","unshift","splice","sort","reverse"],o=Array.prototype;n.each(s,function(e){var t=o[e];o[e]=function(){for(var i=arguments.length,n=new Array(i);i--;)n[i]=arguments[i];var s;return this.__ob__?(("push"==e||"unshift"==e)&&(n=r.inject(n)),"splice"==e&&(n=n.slice(0,2).concat(r.inject(n.slice(2)))),s=t.apply(this,n),this.__ob__.notify()):s=t.apply(this,n),s}}),o.$set=function(e,t){return e>=this.length&&(this.length=e+1),this.splice(e,1,t)[0]},o.$remove=function(e){if(this.length){var t=n.indexOf(this,e);return t>-1?this.splice(t,1):void 0}}},function(e,t,i){i(3);e.exports={priority:3e3,bind:function(e){this.describe.oneTime||(this.el.oneTime=!1),this.update(e)},update:function(e){(void 0===e||null===e)&&(e=""),this.el.html(e)},unbind:function(){}}},function(e,t,i){var n=(i(3),i(24),i(25));e.exports={block:!0,priority:3e3,bind:function(e){this.update(e)},update:function(e){(void 0===e||null===e)&&(e="");var t=n.transfer(e);t.parentNode=this.el.parentNode,this.el.replace(t),this.el=t},unbind:function(){}}},function(e,t,i){function n(){return PAT_ID++}function r(e,t){return e.classList?e.classList.contains(t):e.className?u.trim(e.className).split(/\s+/).indexOf(t)>=0:void 0}function s(e,t){if(e.classList)e.classList.remove(t);else{for(var i=u.trim(e.className).split(/\s+/),n=i.length-1;n>=0;n--)i[n]==t&&i.splice(n,1);e.className=i.join(" ")}}function o(e,t){e.classList?e.classList.add(t):r(e,t)||(e.className+=" "+t)}function a(e){var t=i(8);return t.isBlockDirective(e)}function l(e){for(var t,i=[],n=0;n<e.length;n++)if(t=e[n],a(t.name)){i.push(t);break}return i}var u=i(3),c=u.Class,h=i(1),d={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};PAT_ID=1,TAG_ID=h.tagId;var f={_normalizeDom:function(e){var t=[];return t=11==e.nodeType?e.childNodes||[]:[e]},domBefore:function(e,t){var i=this._normalizeDom(e);this.view.$rootView.fire("beforeAddBlock",i,this),u.before(e,t),this.view.$rootView.fire("afetrAddBlock",i,this)},domAfter:function(e,t){var i=this._normalizeDom(e);this.view.$rootView.fire("beforeAddBlock",i,this),u.after(e,t),this.view.$rootView.fire("afetrAddBlock",i,this)},domReplace:function(e,t){var i=this._normalizeDom(t),n=this._normalizeDom(e);this.view.$rootView.fire("beforeAddBlock",i,this),this.view.$rootView.fire("beforeDeleteBlock",n,this),u.replace(e,t),this.view.$rootView.fire("afterDeleteBlock",n,this),this.view.$rootView.fire("afetrAddBlock",i,this)},domRemove:function(e){var t=this._normalizeDom(e);this.view.$rootView.fire("beforeDeleteBlock",t,this),u.remove(e),this.view.$rootView.fire("afterDeleteBlock",t,this)}},p=c.extend(f,{__VD__:!0,init:function(){},mountView:function(e){var t,i;return i=this,i.view=e,i.mountId(),t=this.deleted?i.mountDeleted(e):i.mountHtml(e)},mountDeleted:function(){return"<!--deleted-"+this.patId+"-->"},mountHtml:function(){return""},mountId:function(){this.patId||(this.patId=n())},_findAndSplice:function(e,t){var i=this.childNodes;i&&u.each(i,function(n,r){n==e&&(e.parentNode=this,t?i.splice(r,1,t):i.splice(r,1))})},getElement:function(){var e=this;if(e.patId&&e.view)return e.element?e.element:(e.element=u.queryRealDom(e),e.element)},clone:function(e){var t,i=null;i=u.deepClone(this.options,function(e){return"childNodes"==e?!0:!1});var n=new this.constructor(i);return n.parentNode=e||this.parentNode,this.options.childNodes&&(t=[],u.each(this.options.childNodes,function(e){t.push(e.clone(n))}),i.childNodes=t,n.childNodes=t),n},pre:function(e){var t,i,n,r=this.parentNode.childNodes;if(r&&0!=r.length&&(n=u.indexOf(r,this),-1!=n)){for(var s=n-1;s>0;s--)if(i=r[s],e||!e&&!i.deleted){t=i;break}return t}},next:function(e){var t,i,n,r=this.parentNode.childNodes;if(r&&0!=r.length&&(n=u.indexOf(r,this),-1!=n)){for(var s=n+1;s<r.length;s++)if(i=r[s],e||!e&&!i.deleted){t=i;break}return t}},replace:function(e){this.deleted||this.remove(!0);var t=this.getElement();if(this.parentNode._findAndSplice(this,e),t){if(e.getElement())if(-1==e.nodeType){for(var i=0,n=e.childNodes.length;n>i;i++)this.domBefore(e.childNodes[i].getElement(),this.getElement());this.domRemove(this.getElement())}else this.domReplace(this.getElement(),e.getElement());else{var r=e.mountView(this.view),s=u.string2frag(r);this.domBefore(s,this.getElement()),this.domRemove(this.getElement())}return e}},before:function(e){var t=e.parentNode.childNodes,i=u.indexOf(t,e);if(e.parentNode.childNodes.splice(i,0,this),this.parentNode=e.parentNode,e.getElement()){var n=-1==e.nodeType?e.endElement:e.getElement();if(this.getElement())if(-1==this.nodeType)for(var r=0,s=this.childNodes.length;s>r;r++)this.domBefore(this.childNodes[r].getElement(),n);else this.domBefore(this.element,n);else{var o=this.mountView(e.view),a=u.string2frag(o);this.domBefore(a,e.getElement())}}},after:function(e){var t=e.parentNode.childNodes,i=u.indexOf(t,e)+1;if(e.parentNode.childNodes.splice(i,0,this),this.parentNode=e.parentNode,e.getElement()){var n=-1==e.nodeType?e.endElement:e.getElement();if(this.getElement())if(-1==this.nodeType)for(var r=0,s=this.childNodes.length;s>r;r++)this.domAfter(this.childNodes[r].getElement(),n);else this.domAfter(this.element,n);else{var o=this.mountView(e.view),a=u.string2frag(o);this.domAfter(a,n)}}},remove:function(e){var t=this.getElement();if(e?this.deleted=!0:this.parentNode._findAndSplice(this),t)if(e){var i=u.string2node(this.mountDeleted());this.domReplace(t,i),this.element=i}else this.domRemove(t)}}),v=p.extend({init:function(e){this.options=e,this.attributes=e.attributes,this.tagName=e.tagName,this.childNodes=e.childNodes,this.hasBlock=e.hasBlock,this.nodeType=1},hasChildNodes:function(){return this.childNodes&&this.childNodes.length&&this.childNodes.length>0},first:function(){return this.childNodes[0]},last:function(){return this.childNodes[this.childNodes.length-1]},hasClass:function(e){var t=u.indexOfKey(this.attributes,"name","class");if(-1==t)return!1;var i=this.attributes[t].value,n=u.trim(i).split(/\s+/);return-1==u.indexOf(n,e)?!1:!0},addClass:function(e){if(e){var t=this.getAttribute("class");t+=" "+e;var i=u.indexOfKey(this.attributes,"name","class"),n={name:"class",value:t};-1!==i?this.attributes[i]=n:this.attributes.push(n),this.getElement()&&o(this.getElement(),e)}},removeClass:function(e){var t=u.indexOfKey(this.attributes,"name","class");if(-1!=t){var i=this.attributes[t].value,n=u.trim(i).split(/\s+/);u.findAndRemove(n,e),this.attributes[t].value=n.join(" "),this.getElement()&&s(this.getElement(),e)}},getAttribute:function(e){var t=u.indexOfKey(this.attributes,"name",e);return-1!==t?this.attributes[t].value:""},setAttribute:function(e,t){(void 0===t||null===t)&&(t="");var i=u.indexOfKey(this.attributes,"name",e),n={name:e,value:t};if(-1!==i?this.attributes[i]=n:this.attributes.push(n),this.getElement()){var r=this.getElement();this.view.$rootView.fire("beforeUpdateAttribute",[r],this),-1!==u.indexOf(["value","checked","selected"],e)&&e in r?r[e]="value"===e?t||"":t:r.setAttribute(e,t),this.view.$rootView.fire("afterUpdateAttribute",[r],e,t,this)}},removeAttribute:function(e){var t=u.indexOfKey(this.attributes,"name",e);if(-1!==t&&this.attributes.splice(t,1),this.getElement()){var i=this.getElement();this.view.$rootView.fire("beforeRemoveAttribute",[i],e,this),node.removeAttribute(e),this.view.$rootView.fire("afterRemoveAttribute",[i],e,this)}},mountHtml:function(e){var t=this.tagName,i="";if(u.each(this.attributes,function(e){0!=e.name.indexOf(h.prefix+"-")&&(i+=[" ",e.name,'="',e.value,'" '].join(""))}),i+=" "+TAG_ID+'="'+this.patId+'"',d[t])return"<"+t+i+" />";var n="";return u.each(this.childNodes,function(t){n+=t.mountView(e)}),"<"+t+i+">"+n+"</"+t+">"}}),m=v.extend({init:function(e){this.options=e,this.nodeType=-1,this.tagName=e.tagName,this.attributes=e.attributes,this.childNodes=e.childNodes,this.hasBlock=e.hasBlock},mountHtml:function(e){var t="";return u.each(this.childNodes,function(i){t+=i.mountView(e)}),t},getElement:function(){if(this.patId&&this.view){if(this.element)return this.element;if(this.deleted)return this.element=u.queryRealDom(this),this.element;var e=this.first().getElement(),t=this.last().getElement();return e&&(this.element=e),t&&(this.endElement=t),e}},remove:function(e){var t=this.getElement();if(e?this.deleted=!0:this.parentNode._findAndSplice(this),
t){this.childNodes;if(e){var i=u.string2node(this.mountDeleted());this.domReplace(t,i),this.element=i}for(;this.childNodes.length;)this.childNodes[0].remove()}},hasChildNodes:function(){return this.childNodes&&this.childNodes.length&&this.childNodes.length>0}}),_=p.extend({init:function(e){this.options=e,this.data=e.data,this.nodeType=3,this.oneTime=!0},html:function(e){(void 0===e||null===e)&&(e=""),u.isString(e)&&(e=u.htmlspecialchars(e)),this.data=e,this.getElement()&&(this.getElement().innerHTML=e)},mountHtml:function(e){var t=this.parentNode,i=-1==t.nodeType&&t.first()===this,n=-1==t.nodeType&&t.last()===this;return!this.oneTime||i||n?"<span "+TAG_ID+'="'+this.patId+'">'+this.data+"</span>":this.data}});e.exports={createRoot:function(e){var t=new m({tagName:"template",attributes:[],childNodes:e,hasBlock:!1});return t.__ROOT__=!0,e&&u.each(e,function(e){e.parentNode=t}),t},createElement:function(e,t,i){var n=[],r=!1;i=i||[],u.each(t,function(e,t){n.push({name:t,value:e}),a(t)&&(r=!0)});var s=null;if("template"==e){if(n=l(n),i&&1==i.length&&1==i[0].nodeType&&!i[0].hasBlock)return i[0].options.attributes=i[0].attributes=i[0].attributes.concat(n),i[0].options.hasBlock=i[0].hasBlock=!0,i[0];if(!i||0==i.length)return;s=new m({tagName:e,attributes:n,childNodes:i,hasBlock:r})}else s=new v({tagName:e,attributes:n,childNodes:i,hasBlock:r});return i&&u.each(i,function(e){e.parentNode=s}),s.hasBlock=r,s},createTextNode:function(e){return e||(e=""),new _({data:e})}}},function(e,t,i){function n(e,t){var i,n=0;t.replace(/<[\w\/\s]+[^>]*>/g,function(s,a){return a>n&&r(e,t.slice(n,a)),i=s.match(/<\/?(\w+)([^>]*?)\/?>$/),e.push({tagName:i[1].toLowerCase()}),e.end++,/<\/\w+/.test(s)?e[e.end].isEnd=!0:""!==i[2]&&(e[e.end].attrs=o(i[2])),n=a+s.length,s}),n!=t.length&&r(e,t.slice(n))}function r(e,t){if(t=t.replace(/^[\n\s\t]+/g,"").replace(/[\n\s\t]+$/g,"")){var i=s(t);u.each(i,function(t){e.push({tagName:TEXT_NODE,text:t}),e.end++})}}function s(e){if(!TAG_RE.test(e))return[e];for(var t,i,n=[],r=TAG_RE.lastIndex=0;t=TAG_RE.exec(e);)i=t.index,i>r&&n.push(e.slice(r,i)),n.push(t[0]),r=i+t[0].length;return r<e.length&&n.push(e.slice(r)),n}function o(e){var t,i,n,r,s={};return e=e.replace(/\ (?=\ )/g,""),t=e.match(/[^=]+=('[^']*'|"[^"]*")|[^\s]+/g),u.each(t,function(e){r=e.indexOf("="),~r?(i=e.slice(0,r),n=e.slice(r+1).replace(/^('|")/,"").replace(/('|")$/,"")):(i=e,n=""),s[u.trim(i)]=u.trim(n)}),s}function a(e,t,i){for(var n,r,s={found:[]},o=t;o>=0;o--)if(e[o].isEnd){if(n=a(e,o-1,e[o]),!n.close_tag,!1)return void u.error(e[o].tagName+" does not have correspond start tag.");n.close_tag.paired=!0,o=n.latest_pointer,0!=n.found.length&&(n.close_tag.children=n.found),r=_(n.close_tag.tagName,n.close_tag.attrs,n.close_tag.children),r&&s.found.unshift(r)}else{if(void 0!=i&&e[o].tagName==i.tagName){s.close_tag=e[o],s.latest_pointer=o;break}e[o].tagName===TEXT_NODE?s.found.unshift(g(e[o].text)):(r=_(e[o].tagName,e[o].attrs),r&&s.found.unshift(r))}return void 0===s.latest_pointer&&(s.latest_pointer=o+1),s}function l(e){var t=e+"";return t=t.replace(p,'<template t-$1="$2">'),t=t.replace(v,'<template t-$1="!($2)">'),t=t.replace(m,"</template>")}var u=i(3),c=i(9),h=i(24),d=i(1),f=d.delimiters,p=new RegExp(f[0]+"\\#([^(]*)\\((.*?)\\)"+f[1],"g"),v=new RegExp(f[0]+"\\^([^(]*)\\((.*?)\\)"+f[1],"g"),m=new RegExp(f[0]+"\\/(.*?)"+f[1],"g"),_=h.createElement,g=h.createTextNode,w=h.createRoot;TAG_RE=c.TAG_RE,TEXT_NODE="text",t.transfer=function(e){if(u.isObject(e)&&e.__VD__)return e;if(""==e)return g("");e=l(e);var t,i,r=[];return r.end=-1,n(r,e),t=a(r,r.length-1),i=w(t.found)}},function(e,t,i){var n=i(3);e.exports={on:function(e,t){return this.__events||(this.__events={}),this.__events[e]||(this.__events[e]=[]),-1===n.indexOf(this.__events,t)&&"function"==typeof t&&this.__events[e].push(t),this},fire:function(e){if(this.__events&&this.__events[e]){var t=Array.prototype.slice.call(arguments,1)||[],i=this.__events[e],n=0,r=i.length;for(n;r>n;n++)i[n].apply(this,t);return this}},off:function(e,t){if(e||t||(this.__events={}),e&&!t&&delete this.__events[e],e&&t)var i=this.__events[e],r=n.indexOf(i,t)(r>-1)&&i.splice(r,1);return this}}}])});